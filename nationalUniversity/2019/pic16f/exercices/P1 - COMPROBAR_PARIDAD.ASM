LIST P=16F887
#include <P16F887.inc>

CBLOCK 0X20
	dato
	veces
	cta
ENDC

#define R_DAT0 dato,0
#define R_CTA0 cta,0
#define on_off PORTB,RB7
#define par PORTA,RA0
#define impar PORTA,RA1

ORG 0 
GOTO setup
ORG 5 
setup	CLRF cta
		CLRF PORTA
		CLRF PORTB
		BANKSEL OSCCON
		MOVLW B'01101100'
		MOVWF OSCCON
		BANKSEL ANSEL
		CLRF ANSEL
		CLRF ANSELH
		BANKSEL TRISA
		MOVLW B'11111100'
		MOVWF TRISA
		MOVLW B'10001111'
		MOVWF TRISB
		BANKSEL WPUB
		CLRF WPUB
		COMF WPUB
		BANKSEL OPTION_REG
		BCF OPTION_REG,NOT_RBPU

main	MOVLW .8
		MOVWF veces
B1		BTFSC R_DAT0
		INCF cta,F
		BCF STATUS,C
		RRF dato
		DECFSZ veces
		GOTO B1
		BTFSC R_CTA0
		MOVLW 0X01
		BTFSS R_CTA0
		MOVLW 0X02
		MOVWF PORTA
		BTFSS on_off
		GOTO $-1
		GOTO main			
END